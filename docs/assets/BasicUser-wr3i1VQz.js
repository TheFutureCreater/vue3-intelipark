import{F as pe,aJ as Te,X as re,aK as ue,bj as te,r as V,H as Ba,s as T,bk as Pe,ak as ke,j as Q,k as be,o as _,c as z,b as S,R as _e,bl as Ne,e as a,bm as ze,v as P,an as de,m as ce,f as D,a7 as M,_ as we,a4 as Ue,x as $e,N as xe,M as Da,K as Ta,bn as Na,L as Se,y as Ae,z as Re,G as fe,Y as za,am as $a,az as xa,g as x,w as l,av as ie,Q as H,ai as F,d as e,bo as Aa,bp as Be,aM as ve,I as Me,aQ as Le,aR as Fe,b1 as Ge,aT as Oe,aC as je,U as qe,E as q,p as Ke,h as We}from"./index-oRu2cjMH.js";import{E as Ye,a as Ze,b as Je,c as He,d as Qe,v as Xe,_ as Ra}from"./el-table-column-BmqCEtHz.js";import{U as oe,C as ge,b as ea,u as aa,c as la,e as ta,d as oa,I as Ee,t as Ma,E as na,a as sa}from"./el-input-BDO7TuJp.js";import"./el-scrollbar-DUcjJf-2.js";import"./el-popper-BefnKgnc.js";import{a as ia,E as ra}from"./el-form-item-BbDMPNc9.js";import"./el-tooltip-l0sNRNKZ.js";import{_ as ua,b as da,c as ca,e as pa}from"./index-DR197BeK.js";import{v as La,E as Fa}from"./el-date-picker-ZJVy8-qX.js";import{E as va}from"./el-row-B8cGyQEE.js";import{i as Ga,E as he}from"./el-overlay-VJhms_I-.js";import{_ as ma}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{e as Oa,a as ja,g as qa,b as Ka,d as De}from"./user-BI9CrYxB.js";import{u as fa,a as Wa}from"./constants-DBJJeGRQ.js";import"./scroll-CUnNOiJo.js";import"./debounce-BP9IrIM3.js";import"./index-lCH7LjYE.js";const ga=pe({modelValue:{type:[String,Number,Boolean],default:void 0},size:Te,disabled:Boolean,label:{type:[String,Number,Boolean],default:void 0},value:{type:[String,Number,Boolean],default:void 0},name:{type:String,default:void 0}}),Ya=pe({...ga,border:Boolean}),ha={[oe]:s=>re(s)||ue(s)||te(s),[ge]:s=>re(s)||ue(s)||te(s)},ba=Symbol("radioGroupKey"),_a=(s,I)=>{const p=V(),t=Ba(ba,void 0),c=T(()=>!!t),E=T(()=>Pe(s.value)?s.label:s.value),r=T({get(){return c.value?t.modelValue:s.modelValue},set(y){c.value?t.changeEvent(y):I&&I(oe,y),p.value.checked=s.modelValue===E.value}}),h=ea(T(()=>t==null?void 0:t.size)),n=aa(T(()=>t==null?void 0:t.disabled)),d=V(!1),w=T(()=>n.value||c.value&&r.value!==E.value?-1:0);return ke({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-radio",ref:"https://element-plus.org/en-US/component/radio.html"},T(()=>c.value&&Pe(s.value))),{radioRef:p,isGroup:c,radioGroup:t,focus:d,size:h,disabled:n,tabIndex:w,modelValue:r,actualValue:E}},Za=["value","name","disabled"],Ja=Q({name:"ElRadio"}),Ha=Q({...Ja,props:Ya,emits:ha,setup(s,{emit:I}){const p=s,t=be("radio"),{radioRef:c,radioGroup:E,focus:r,size:h,disabled:n,modelValue:d,actualValue:w}=_a(p,I);function y(){Ue(()=>I("change",d.value))}return(v,b)=>{var A;return _(),z("label",{class:P([a(t).b(),a(t).is("disabled",a(n)),a(t).is("focus",a(r)),a(t).is("bordered",v.border),a(t).is("checked",a(d)===a(w)),a(t).m(a(h))])},[S("span",{class:P([a(t).e("input"),a(t).is("disabled",a(n)),a(t).is("checked",a(d)===a(w))])},[_e(S("input",{ref_key:"radioRef",ref:c,"onUpdate:modelValue":b[0]||(b[0]=K=>ze(d)?d.value=K:null),class:P(a(t).e("original")),value:a(w),name:v.name||((A=a(E))==null?void 0:A.name),disabled:a(n),type:"radio",onFocus:b[1]||(b[1]=K=>r.value=!0),onBlur:b[2]||(b[2]=K=>r.value=!1),onChange:y,onClick:b[3]||(b[3]=de(()=>{},["stop"]))},null,42,Za),[[Ne,a(d)]]),S("span",{class:P(a(t).e("inner"))},null,2)],2),S("span",{class:P(a(t).e("label")),onKeydown:b[4]||(b[4]=de(()=>{},["stop"]))},[ce(v.$slots,"default",{},()=>[D(M(v.label),1)])],34)],2)}}});var Qa=we(Ha,[["__file","radio.vue"]]);const Xa=pe({...ga}),el=["value","name","disabled"],al=Q({name:"ElRadioButton"}),ll=Q({...al,props:Xa,setup(s){const I=s,p=be("radio"),{radioRef:t,focus:c,size:E,disabled:r,modelValue:h,radioGroup:n,actualValue:d}=_a(I),w=T(()=>({backgroundColor:(n==null?void 0:n.fill)||"",borderColor:(n==null?void 0:n.fill)||"",boxShadow:n!=null&&n.fill?`-1px 0 0 0 ${n.fill}`:"",color:(n==null?void 0:n.textColor)||""}));return(y,v)=>{var b;return _(),z("label",{class:P([a(p).b("button"),a(p).is("active",a(h)===a(d)),a(p).is("disabled",a(r)),a(p).is("focus",a(c)),a(p).bm("button",a(E))])},[_e(S("input",{ref_key:"radioRef",ref:t,"onUpdate:modelValue":v[0]||(v[0]=A=>ze(h)?h.value=A:null),class:P(a(p).be("button","original-radio")),value:a(d),type:"radio",name:y.name||((b=a(n))==null?void 0:b.name),disabled:a(r),onFocus:v[1]||(v[1]=A=>c.value=!0),onBlur:v[2]||(v[2]=A=>c.value=!1),onClick:v[3]||(v[3]=de(()=>{},["stop"]))},null,42,el),[[Ne,a(h)]]),S("span",{class:P(a(p).be("button","inner")),style:$e(a(h)===a(d)?a(w):{}),onKeydown:v[4]||(v[4]=de(()=>{},["stop"]))},[ce(y.$slots,"default",{},()=>[D(M(y.label),1)])],38)],2)}}});var wa=we(ll,[["__file","radio-button.vue"]]);const tl=pe({id:{type:String,default:void 0},size:Te,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:void 0},fill:{type:String,default:""},label:{type:String,default:void 0},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0},...fa(["ariaLabel"])}),ol=ha,nl=["id","aria-label","aria-labelledby"],sl=Q({name:"ElRadioGroup"}),il=Q({...sl,props:tl,emits:ol,setup(s,{emit:I}){const p=s,t=be("radio"),c=Wa(),E=V(),{formItem:r}=la(),{inputId:h,isLabeledByFormItem:n}=ta(p,{formItemContext:r}),d=y=>{I(oe,y),Ue(()=>I("change",y))};xe(()=>{const y=E.value.querySelectorAll("[type=radio]"),v=y[0];!Array.from(y).some(b=>b.checked)&&v&&(v.tabIndex=0)});const w=T(()=>p.name||c.value);return Da(ba,Ta({...Na(p),changeEvent:d,name:w})),Se(()=>p.modelValue,()=>{p.validateEvent&&(r==null||r.validate("change").catch(y=>oa()))}),ke({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-radio-group",ref:"https://element-plus.org/en-US/component/radio.html"},T(()=>!!p.label)),(y,v)=>(_(),z("div",{id:a(h),ref_key:"radioGroupRef",ref:E,class:P(a(t).b("group")),role:"radiogroup","aria-label":a(n)?void 0:y.label||y.ariaLabel||"radio-group","aria-labelledby":a(n)?a(r).labelId:void 0},[ce(y.$slots,"default")],10,nl))}});var ya=we(il,[["__file","radio-group.vue"]]);Ae(Qa,{RadioButton:wa,RadioGroup:ya});const rl=Re(ya),ul=Re(wa),dl=pe({modelValue:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,validator:Ga},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},inactiveActionIcon:{type:fe},activeActionIcon:{type:fe},activeIcon:{type:fe},inactiveIcon:{type:fe},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:za(Function)},id:String,tabindex:{type:[String,Number]},label:{type:String,default:void 0},...fa(["ariaLabel"])}),cl={[oe]:s=>te(s)||re(s)||ue(s),[ge]:s=>te(s)||re(s)||ue(s),[Ee]:s=>te(s)||re(s)||ue(s)},pl=["onClick"],vl=["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"],ml=["aria-hidden"],fl=["aria-hidden"],gl=["aria-hidden"],Va="ElSwitch",hl=Q({name:Va}),bl=Q({...hl,props:dl,emits:cl,setup(s,{expose:I,emit:p}){const t=s,{formItem:c}=la(),E=ea(),r=be("switch"),{inputId:h}=ta(t,{formItemContext:c}),n=aa(T(()=>t.loading)),d=V(t.modelValue!==!1),w=V(),y=V(),v=T(()=>[r.b(),r.m(E.value),r.is("disabled",n.value),r.is("checked",k.value)]),b=T(()=>[r.e("label"),r.em("label","left"),r.is("active",!k.value)]),A=T(()=>[r.e("label"),r.em("label","right"),r.is("active",k.value)]),K=T(()=>({width:$a(t.width)}));Se(()=>t.modelValue,()=>{d.value=!0});const X=T(()=>d.value?t.modelValue:!1),k=T(()=>X.value===t.activeValue);[t.activeValue,t.inactiveValue].includes(X.value)||(p(oe,t.inactiveValue),p(ge,t.inactiveValue),p(Ee,t.inactiveValue)),Se(k,i=>{var N;w.value.checked=i,t.validateEvent&&((N=c==null?void 0:c.validate)==null||N.call(c,"change").catch(se=>oa()))});const Y=()=>{const i=k.value?t.inactiveValue:t.activeValue;p(oe,i),p(ge,i),p(Ee,i),Ue(()=>{w.value.checked=k.value})},ee=()=>{if(n.value)return;const{beforeChange:i}=t;if(!i){Y();return}const N=i();[Be(N),te(N)].includes(!0)||Ma(Va,"beforeChange must return type `Promise<boolean>` or `boolean`"),Be(N)?N.then(ae=>{ae&&Y()}).catch(ae=>{}):N&&Y()},ne=()=>{var i,N;(N=(i=w.value)==null?void 0:i.focus)==null||N.call(i)};return xe(()=>{w.value.checked=k.value}),ke({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-switch",ref:"https://element-plus.org/en-US/component/switch.html"},T(()=>!!t.label)),I({focus:ne,checked:k}),(i,N)=>(_(),z("div",{class:P(a(v)),onClick:de(ee,["prevent"])},[S("input",{id:a(h),ref_key:"input",ref:w,class:P(a(r).e("input")),type:"checkbox",role:"switch","aria-checked":a(k),"aria-disabled":a(n),"aria-label":i.label||i.ariaLabel,name:i.name,"true-value":i.activeValue,"false-value":i.inactiveValue,disabled:a(n),tabindex:i.tabindex,onChange:Y,onKeydown:xa(ee,["enter"])},null,42,vl),!i.inlinePrompt&&(i.inactiveIcon||i.inactiveText)?(_(),z("span",{key:0,class:P(a(b))},[i.inactiveIcon?(_(),x(a(H),{key:0},{default:l(()=>[(_(),x(ie(i.inactiveIcon)))]),_:1})):F("v-if",!0),!i.inactiveIcon&&i.inactiveText?(_(),z("span",{key:1,"aria-hidden":a(k)},M(i.inactiveText),9,ml)):F("v-if",!0)],2)):F("v-if",!0),S("span",{ref_key:"core",ref:y,class:P(a(r).e("core")),style:$e(a(K))},[i.inlinePrompt?(_(),z("div",{key:0,class:P(a(r).e("inner"))},[i.activeIcon||i.inactiveIcon?(_(),x(a(H),{key:0,class:P(a(r).is("icon"))},{default:l(()=>[(_(),x(ie(a(k)?i.activeIcon:i.inactiveIcon)))]),_:1},8,["class"])):i.activeText||i.inactiveText?(_(),z("span",{key:1,class:P(a(r).is("text")),"aria-hidden":!a(k)},M(a(k)?i.activeText:i.inactiveText),11,fl)):F("v-if",!0)],2)):F("v-if",!0),S("div",{class:P(a(r).e("action"))},[i.loading?(_(),x(a(H),{key:0,class:P(a(r).is("loading"))},{default:l(()=>[e(a(Aa))]),_:1},8,["class"])):a(k)?ce(i.$slots,"active-action",{key:1},()=>[i.activeActionIcon?(_(),x(a(H),{key:0},{default:l(()=>[(_(),x(ie(i.activeActionIcon)))]),_:1})):F("v-if",!0)]):a(k)?F("v-if",!0):ce(i.$slots,"inactive-action",{key:2},()=>[i.inactiveActionIcon?(_(),x(a(H),{key:0},{default:l(()=>[(_(),x(ie(i.inactiveActionIcon)))]),_:1})):F("v-if",!0)])],2)],6),!i.inlinePrompt&&(i.activeIcon||i.activeText)?(_(),z("span",{key:1,class:P(a(A))},[i.activeIcon?(_(),x(a(H),{key:0},{default:l(()=>[(_(),x(ie(i.activeIcon)))]),_:1})):F("v-if",!0),!i.activeIcon&&i.activeText?(_(),z("span",{key:1,"aria-hidden":!a(k)},M(i.activeText),9,gl)):F("v-if",!0)],2)):F("v-if",!0)],10,pl))}});var _l=we(bl,[["__file","switch.vue"]]);const wl=Ae(_l),yl=s=>ve({url:"/vehicle/list",params:s}),Vl=s=>ve({url:"/vehicle",method:"DELETE",params:{vehicleId:s}}),Il=s=>ve({url:"/vehicle",method:"POST",data:s}),Sl=s=>ve({url:"/vehicle",method:"PUT",data:s}),El=s=>ve({url:"/vehicle",method:"DELETE",data:s}),kl=s=>(Ke("data-v-d13a4413"),s=s(),We(),s),Ul={class:"box-container"},Cl={class:"top-elform-query"},Pl=kl(()=>S("h1",null,"用户车辆信息",-1)),Bl={__name:"VehicleTable",props:{userId:Number},setup(s){const I=V(!0),p=s;console.log("车辆Box获取user-id:"+p.userId);const t=V(0),c=V({pageNum:1,pageSize:20,searchWord:"",vehicleModel:"",userId:p.userId}),E=V([]),r=V([]),h=V(!1),n=V(!0),d=V(),w=V(),y=async U=>{U===2?(h.value=!h.value,console.log("取消对话框操作"),w.value&&w.value.resetFields()):U===1?(console.log("确认对话框操作"),w.value&&await w.value.validate(),h.value=!h.value,n.value?(await Sl(d.value)).data.code===200&&q.success("编辑成功"):(await Il(d.value)).data.code===200&&q.success("添加成功"),v()):U===3?(console.log("重置对话框操作"),w.value&&w.value.resetFields()):console.log(Promise.reject("对话框返回数字错误")),console.log("结束对话框操作")},v=async()=>{I.value=!0;const U=await yl(c.value);t.value=U.data.data.totalRow,E.value=U.data.data.records,I.value=!1};v();const b=U=>{r.value=U},A=()=>{console.log("submit!"),v()},K=()=>{console.log("信息添加逻辑"),d.value={vehicleId:0,userId:0,vehicleBrand:"",vehicleModel:1,licencePlate:"",electricity:0},n.value=!1,h.value=!h.value},X=U=>{console.log("单行编辑操作"),d.value=JSON.parse(JSON.stringify(U)),n.value=!0,h.value=!h.value},k=async U=>{console.log("单行删除操作"+U),await he.confirm("你确认要删除该条信息么？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}).then(async()=>{(await Vl(U)).data.code===200&&q.success("删除成功"),v()}).catch(()=>{})},Y=async()=>{if(r.value.length===0){q.error("未选中任何数据");return}const U=r.value.map(g=>g.id);await he.confirm("你确认要删除多条信息么？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}).then(async()=>{(await El(U)).data.code===200&&q.success("删除成功"),v()}).catch(()=>{})},ee=()=>{console.log(c.value.pageSize),v()},ne=()=>{console.log(c.value.pageNum),v()};function i(U,g,$){/^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$/.test(g)?$():$(new Error("请输入有效的车牌"))}function N(U,g,$){/^\d+(\.\d{2})?$/.test(g)?$():$(new Error("请输入有效的电量（保留两位小数）"))}const se={userId:[{required:!0,message:"未输入用户ID",trigger:"manual"}],vehicleBrand:[{required:!0,message:"未输入汽车品牌",trigger:"manual"}],licencePlate:[{required:!0,message:"未输入车牌",trigger:"manual"},{validator:i,trigger:"manual"}],electricity:[{required:!0,message:"未输入电量",trigger:"manual"},{validator:N,trigger:"manual"}]},ae=()=>{console.log("重置查询表单"),c.value={pageNum:1,pageSize:20,searchWord:"",vehicleModel:"",userId:""}};return(U,g)=>{const $=na,R=ia,m=va,o=Ye,C=Ze,W=ra,B=ua,Z=H,L=sa,G=da,le=ca,ye=pa,O=Je,me=He,Ve=Qe,J=Xe;return _(),z(qe,null,[e(B,{selectShow:h.value,dialogTitle:"车辆基础信息"+(n.value?"编辑":"添加"),onDoneEditAdd:y},{default:l(()=>[e(W,{ref_key:"ruleFormRef",ref:w,model:d.value,rules:se,"label-width":"auto","status-icon":""},{default:l(()=>[e(m,{justify:"space-between"},{default:l(()=>[e(R,{label:"用户id",prop:"userId"},{default:l(()=>[e($,{modelValue:d.value.userId,"onUpdate:modelValue":g[0]||(g[0]=f=>d.value.userId=f),formatter:f=>f.replace(/\D/g,""),parser:f=>f.replace(/\D/g,""),placeholder:"输入用户id",clearable:"",style:{width:"200px"}},null,8,["modelValue","formatter","parser"])]),_:1}),e(R,{label:"汽车品牌",prop:"vehicleBrand",style:{width:"360px"},clearable:""},{default:l(()=>[e($,{modelValue:d.value.vehicleBrand,"onUpdate:modelValue":g[1]||(g[1]=f=>d.value.vehicleBrand=f),placeholder:"请输入汽车品牌"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{justify:"space-between"},{default:l(()=>[e(R,{label:"充电车型",prop:"vehicleModel",style:{width:"360px"}},{default:l(()=>[e(C,{modelValue:d.value.vehicleModel,"onUpdate:modelValue":g[2]||(g[2]=f=>d.value.vehicleModel=f),placeholder:"请选择"},{default:l(()=>[e(o,{label:"直流快充",value:1}),e(o,{label:"交流慢充",value:2}),e(o,{label:"交直流混合充电",value:3})]),_:1},8,["modelValue"])]),_:1}),e(R,{label:"车牌号",prop:"licencePlate",style:{width:"360px"},clearable:""},{default:l(()=>[e($,{modelValue:d.value.licencePlate,"onUpdate:modelValue":g[3]||(g[3]=f=>d.value.licencePlate=f),placeholder:"请输入车牌号"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{justify:"space-between"},{default:l(()=>[e(R,{label:"电池容量",prop:"electricity",style:{width:"360px"},clearable:""},{default:l(()=>[e($,{modelValue:d.value.electricity,"onUpdate:modelValue":g[4]||(g[4]=f=>d.value.electricity=f),placeholder:"请输入电池容量"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["selectShow","dialogTitle"]),S("div",Ul,[S("div",Cl,[e(ye,{class:"el-dropdown-del-all"},{dropdown:l(()=>[e(le,null,{default:l(()=>[e(G,{onClick:Y},{default:l(()=>[D("全部删除")]),_:1})]),_:1})]),default:l(()=>[e(L,{type:"primary"},{default:l(()=>[D(M(r.value.length===0?"未选中":`选中${r.value.length}行`)+" ",1),e(Z,{class:"el-icon--right"},{default:l(()=>[e(a(Me))]),_:1})]),_:1})]),_:1}),Pl,e(W,{inline:!0,model:c.value,style:{"text-align":"end"}},{default:l(()=>[e(R,{label:"搜索关键字"},{default:l(()=>[e($,{modelValue:c.value.searchWord,"onUpdate:modelValue":g[5]||(g[5]=f=>c.value.searchWord=f),placeholder:"输入关键字",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),e(R,{label:"充电车型"},{default:l(()=>[e(C,{modelValue:c.value.vehicleModel,"onUpdate:modelValue":g[6]||(g[6]=f=>c.value.vehicleModel=f),placeholder:"请选择",clearable:"",style:{width:"150px"}},{default:l(()=>[e(o,{label:"直流快充",value:"1"}),e(o,{label:"交流慢充",value:"2"}),e(o,{label:"交直流混合充电",value:"3"})]),_:1},8,["modelValue"])]),_:1}),e(R,null,{default:l(()=>[e(L,{plain:"",type:"warning",onClick:ae,icon:a(Le)},{default:l(()=>[D("重置")]),_:1},8,["icon"]),e(L,{type:"primary",onClick:A,icon:a(Fe)},{default:l(()=>[D("查询")]),_:1},8,["icon"]),e(L,{type:"success",onClick:K,icon:a(Ge)},{default:l(()=>[D("添加")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_e((_(),x(me,{border:"",data:E.value,style:{width:"100%"},"highlight-current-row":"",onSelectionChange:b},{default:l(()=>[e(O,{type:"selection",width:"55"}),e(O,{fixed:"","show-overflow-tooltip":"",prop:"vehicleId",label:"车辆ID",width:"100"}),e(O,{fixed:"","show-overflow-tooltip":"",prop:"userId",label:"用户ID",width:"100"}),e(O,{prop:"vehicleBrand",label:"车辆品牌",width:"200"}),e(O,{prop:"vehicleModel",label:"充电车型",width:"200"},{default:l(f=>[S("div",null,M([1,2,3].includes(f.row.vehicleModel)?a(La)[f.row.vehicleModel-1]:"未知车型"),1)]),_:1}),e(O,{prop:"licencePlate",label:"车牌号",width:"200"}),e(O,{prop:"electricity",label:"电池容量","min-width":"200"},{default:l(f=>[S("div",null,M(f.row.electricity+" kWh"),1)]),_:1}),e(O,{fixed:"right",label:"单行操作",width:"200"},{default:l(f=>[e(L,{text:"",bg:"",type:"primary",size:"small",onClick:Ie=>X(f.row),icon:a(Oe)},{default:l(()=>[D(" 编辑 ")]),_:2},1032,["onClick","icon"]),e(L,{text:"",bg:"",type:"danger",size:"small",onClick:Ie=>k(f.row.vehicleId),icon:a(je)},{default:l(()=>[D(" 删除 ")]),_:2},1032,["onClick","icon"])]),_:1})]),_:1},8,["data"])),[[J,I.value]]),e(Ve,{style:{"margin-top":"10px"},"current-page":c.value.pageNum,"onUpdate:currentPage":g[7]||(g[7]=f=>c.value.pageNum=f),"page-size":c.value.pageSize,"onUpdate:pageSize":g[8]||(g[8]=f=>c.value.pageSize=f),"page-sizes":[10,15,20,40],layout:"total, sizes, prev, pager, next, jumper",total:t.value,onSizeChange:ee,onCurrentChange:ne,"hide-on-single-page":""},null,8,["current-page","page-size","total"])])],64)}}},Dl=ma(Bl,[["__scopeId","data-v-d13a4413"]]),Ce=s=>(Ke("data-v-23b400f2"),s=s(),We(),s),Tl=Ce(()=>S("span",null,"用户基础信息管理",-1)),Nl={class:"top-elform-query"},zl={key:0},$l={key:1,style:{"text-align":"center"}},xl=Ce(()=>S("div",{style:{height:"20px"}},null,-1)),Al=Ce(()=>S("div",{style:{height:"10px"}},null,-1)),Rl={__name:"BasicUser",setup(s){const I=V(!0),p=V(0),t=V({pageNum:1,pageSize:20,searchWord:"",state:"",vip:"",role:"",userId:""}),c=V([]),E=V([]),r=V(!1),h=V(!0),n=V(),d=V(),w=()=>{const m=new URLSearchParams(window.location.search);t.value.userId&&m.set("userId",t.value.userId);const o=m.toString()===""?window.location.pathname:`?${m}`,C=history.state?history.state:null;window.history.replaceState(C,"",o)};(()=>{const o=new URLSearchParams(window.location.search).get("userId");o&&(t.value.userId=o),w()})();const v=async m=>{m===2?(r.value=!r.value,console.log("取消对话框操作"),d.value&&d.value.resetFields()):m===1?(console.log("确认对话框操作"),d.value&&await d.value.validate(),r.value=!r.value,h.value?(await Oa(n.value)).data.code===200&&q.success("编辑成功"):(await ja(n.value)).data.code===200&&q.success("添加成功"),b()):m===3?(console.log("重置对话框操作"),d.value&&d.value.resetFields()):console.log(Promise.reject("对话框返回数字错误")),console.log("结束对话框操作")},b=async()=>{I.value=!0;const m=await qa(t.value);p.value=m.data.data.totalRow,c.value=m.data.data.records,I.value=!1,w()},A=async()=>{I.value=!0;const m=await Ka(t.value.userId);p.value=1,c.value=[m.data.data],I.value=!1};t.value.userId?A():b();const K=m=>{E.value=m},X=()=>{console.log("submit!"),b()},k=()=>{console.log("信息添加逻辑"),n.value={id:0,username:"",state:1,phoneNum:"",balance:0,vip:0,vipDisableTime:"",password:"",role:"admin"},h.value=!1,r.value=!r.value},Y=m=>{console.log("单行编辑操作"),n.value=JSON.parse(JSON.stringify(m)),h.value=!0,r.value=!r.value},ee=async m=>{console.log("单行删除操作"+m),await he.confirm("你确认要删除该条信息么？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}).then(async()=>{(await De([m])).data.code===200&&q.success("删除成功"),b()}).catch(()=>{})},ne=async()=>{if(E.value.length===0){q.error("未选中任何数据");return}const m=E.value.map(o=>o.id);await he.confirm("你确认要删除多条信息么？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}).then(async()=>{(await De(m)).data.code===200&&q.success("删除成功"),b()}).catch(()=>{})},i=()=>{console.log(t.value.pageSize),b()},N=()=>{console.log(t.value.pageNum),b()};function se(m,o,C){const W=new Date(o),B=new Date;console.log(o),W>B?C():C(new Error("所选日期应该大于当前时间"))}function ae(m,o,C){/^\d{11}$/.test(o)?C():C(new Error("请输入有效的手机号"))}function U(m,o,C){/^\d+(\.\d{2})?$/.test(o)?C():C(new Error("请输入有效的金额（保留两位小数）"))}function g(m,o,C){/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/.test(o)?C():C(new Error("请输入有效的金额（保留两位小数）"))}const $={username:[{required:!0,message:"未输入用户名",trigger:"manual"},{min:1,max:20,message:"用户名长度为1-20个字符",trigger:"manual"}],phoneNum:[{required:!0,message:"未输入电话号码",trigger:"manual"},{validator:ae,trigger:"manual"}],vipDisableTime:[{required:!0,message:"未选择日期",trigger:"manual"},{validator:se,trigger:"manual"}],balance:[{required:!0,message:"未输入余额",trigger:"manual"},{validator:U,trigger:"manual"}],password:[{required:!0,message:"未输入密码",trigger:"manual"},{min:8,message:"密码长度至少为8个字符",trigger:"manual"},{validator:g,message:"密码需要包含字母和数字",trigger:"manual"}]},R=()=>{console.log("重置查询表单"),t.value={pageNum:1,pageSize:20,searchWord:"",state:"",vip:"",role:""}};return(m,o)=>{const C=ul,W=rl,B=ia,Z=na,L=va,G=Ye,le=Ze,ye=wl,O=Fa,me=ra,Ve=ua,J=sa,f=H,Ie=da,Ia=ca,Sa=pa,j=Je,Ea=He,ka=Qe,Ua=Ra,Ca=Xe;return _(),z(qe,null,[e(Ve,{selectShow:r.value,dialogTitle:"用户基础信息"+(h.value?"编辑":"添加"),onDoneEditAdd:v},{default:l(()=>[e(me,{ref_key:"ruleFormRefUser",ref:d,model:n.value,rules:$,"label-width":"auto","status-icon":""},{default:l(()=>[e(L,{justify:"space-between"},{default:l(()=>[e(B,{label:"角色",prop:"role"},{default:l(()=>[e(W,{modelValue:n.value.role,"onUpdate:modelValue":o[0]||(o[0]=u=>n.value.role=u)},{default:l(()=>[e(C,{value:"user"},{default:l(()=>[D("普通用户")]),_:1}),e(C,{value:"admin"},{default:l(()=>[D("系统管理员")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(B,{label:"用户名",prop:"username",style:{width:"360px"},clearable:""},{default:l(()=>[e(Z,{modelValue:n.value.username,"onUpdate:modelValue":o[1]||(o[1]=u=>n.value.username=u),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1})]),_:1}),e(L,{justify:"space-between"},{default:l(()=>[e(B,{label:"账户状态",prop:"state",style:{width:"360px"}},{default:l(()=>[e(le,{modelValue:n.value.state,"onUpdate:modelValue":o[2]||(o[2]=u=>n.value.state=u),placeholder:"请选择"},{default:l(()=>[e(G,{label:"正常",value:1}),e(G,{label:"锁定",value:2})]),_:1},8,["modelValue"])]),_:1}),e(B,{label:"手机号",prop:"phoneNum",style:{width:"360px"},clearable:""},{default:l(()=>[e(Z,{modelValue:n.value.phoneNum,"onUpdate:modelValue":o[3]||(o[3]=u=>n.value.phoneNum=u),placeholder:"请输入电话号码"},null,8,["modelValue"])]),_:1})]),_:1}),e(L,{justify:"space-between"},{default:l(()=>[e(B,{label:"VIP身份",prop:"vip"},{default:l(()=>[e(ye,{modelValue:n.value.vip,"onUpdate:modelValue":o[4]||(o[4]=u=>n.value.vip=u),disabled:n.value.role==="admin","active-value":1,"inactive-value":0},null,8,["modelValue","disabled"])]),_:1}),e(B,{label:"VIP到期时间",prop:n.value.vip===1?"vipDisableTime":"",style:{width:"360px"}},{default:l(()=>[e(O,{modelValue:n.value.vipDisableTime,"onUpdate:modelValue":o[5]||(o[5]=u=>n.value.vipDisableTime=u),type:"datetime",placeholder:"选择时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD h:m:s",disabled:n.value.vip===0},null,8,["modelValue","disabled"])]),_:1},8,["prop"])]),_:1}),e(L,{justify:"space-between"},{default:l(()=>[e(B,{label:"用户余额",prop:"balance",style:{width:"360px"}},{default:l(()=>[e(Z,{modelValue:n.value.balance,"onUpdate:modelValue":o[6]||(o[6]=u=>n.value.balance=u),disabled:n.value.role==="admin",placeholder:"输入用户余额"},null,8,["modelValue","disabled"])]),_:1}),e(B,{label:"登录密码",prop:"password",style:{width:"360px"}},{default:l(()=>[e(Z,{modelValue:n.value.password,"onUpdate:modelValue":o[7]||(o[7]=u=>n.value.password=u),type:"password",placeholder:"输入密码","show-password":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["selectShow","dialogTitle"]),e(Ua,{title:!0},{header:l(()=>[Tl,S("div",null,[e(J,{type:"success",onClick:k,icon:a(Ge)},{default:l(()=>[D("添加")]),_:1},8,["icon"])])]),content:l(()=>[S("div",Nl,[e(Sa,{class:"el-dropdown-del-all"},{dropdown:l(()=>[e(Ia,null,{default:l(()=>[e(Ie,{onClick:ne},{default:l(()=>[D("全部删除")]),_:1})]),_:1})]),default:l(()=>[e(J,{type:"primary"},{default:l(()=>[D(M(E.value.length===0?"未选中":`选中${E.value.length}行`)+" ",1),e(f,{class:"el-icon--right"},{default:l(()=>[e(a(Me))]),_:1})]),_:1})]),_:1}),e(me,{inline:!0,model:t.value,style:{"text-align":"end"}},{default:l(()=>[e(B,{label:"搜索关键字"},{default:l(()=>[e(Z,{modelValue:t.value.searchWord,"onUpdate:modelValue":o[8]||(o[8]=u=>t.value.searchWord=u),placeholder:"输入关键字",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(B,{label:"用户ID"},{default:l(()=>[e(Z,{modelValue:t.value.userId,"onUpdate:modelValue":o[9]||(o[9]=u=>t.value.userId=u),formatter:u=>u.replace(/\D/g,""),parser:u=>u.replace(/\D/g,""),placeholder:"输入用户ID",clearable:"",style:{width:"200px"}},null,8,["modelValue","formatter","parser"])]),_:1}),e(B,{label:"账户状态"},{default:l(()=>[e(le,{modelValue:t.value.state,"onUpdate:modelValue":o[10]||(o[10]=u=>t.value.state=u),placeholder:"请选择",clearable:"",style:{width:"200px"}},{default:l(()=>[e(G,{label:"正常",value:"1"}),e(G,{label:"锁定",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(B,{label:"VIP身份"},{default:l(()=>[e(le,{modelValue:t.value.vip,"onUpdate:modelValue":o[11]||(o[11]=u=>t.value.vip=u),placeholder:"请选择",clearable:"",style:{width:"200px"}},{default:l(()=>[e(G,{label:"VIP用户",value:"1"}),e(G,{label:"非VIP用户",value:"0"})]),_:1},8,["modelValue"])]),_:1}),e(B,{label:"角色"},{default:l(()=>[e(le,{modelValue:t.value.role,"onUpdate:modelValue":o[12]||(o[12]=u=>t.value.role=u),placeholder:"请选择",clearable:"",style:{width:"200px"}},{default:l(()=>[e(G,{label:"普通用户",value:"user"}),e(G,{label:"系统管理员",value:"admin"})]),_:1},8,["modelValue"])]),_:1}),e(B,null,{default:l(()=>[e(J,{plain:"",type:"warning",onClick:R,icon:a(Le)},{default:l(()=>[D("重置")]),_:1},8,["icon"]),e(J,{type:"primary",onClick:X,icon:a(Fe)},{default:l(()=>[D("查询")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_e((_(),x(Ea,{data:c.value,style:{width:"100%"},"highlight-current-row":"",onSelectionChange:K},{default:l(()=>[e(j,{type:"selection",width:"55"}),e(j,{type:"expand"},{default:l(u=>[u.row.role==="user"?(_(),z("div",zl,[e(Dl,{userId:u.row.id},null,8,["userId"])])):(_(),z("div",$l,"无车辆信息"))]),_:1}),e(j,{"show-overflow-tooltip":"",prop:"id",label:"ID",width:"100"}),e(j,{prop:"role",label:"角色",width:"100"},{default:l(u=>[S("span",null,M(u.row.role==="admin"?"管理员":"用户"),1)]),_:1}),e(j,{prop:"username",label:"用户名",width:"200"}),e(j,{prop:"state",label:"状态",width:"100"},{default:l(u=>[S("span",null,M(u.row.state===1?"正常":"锁定"),1)]),_:1}),e(j,{prop:"phoneNum",label:"手机号",width:"180"}),e(j,{prop:"balance",label:"账户余额",width:"160"}),e(j,{prop:"vip",label:"VIP身份","min-width":"300"},{default:l(u=>[S("span",null,M(u.row.vip===1?`VIP到期时间：${u.row.vipDisableTime}`:"非VIP用户"),1)]),_:1}),e(j,{fixed:"right",label:"单行操作",width:"200"},{default:l(u=>[e(J,{text:"",bg:"",type:"primary",size:"small",onClick:Pa=>Y(u.row),icon:a(Oe)},{default:l(()=>[D(" 编辑 ")]),_:2},1032,["onClick","icon"]),e(J,{text:"",bg:"",type:"danger",size:"small",onClick:Pa=>ee(u.row.id),icon:a(je)},{default:l(()=>[D(" 删除 ")]),_:2},1032,["onClick","icon"])]),_:1})]),_:1},8,["data"])),[[Ca,I.value]]),xl,e(ka,{"current-page":t.value.pageNum,"onUpdate:currentPage":o[13]||(o[13]=u=>t.value.pageNum=u),"page-size":t.value.pageSize,"onUpdate:pageSize":o[14]||(o[14]=u=>t.value.pageSize=u),"page-sizes":[10,15,20,40],layout:"total, sizes, prev, pager, next, jumper",total:p.value,onSizeChange:i,onCurrentChange:N,"hide-on-single-page":""},null,8,["current-page","page-size","total"]),Al]),_:1})],64)}}},lt=ma(Rl,[["__scopeId","data-v-23b400f2"]]);export{lt as default};
