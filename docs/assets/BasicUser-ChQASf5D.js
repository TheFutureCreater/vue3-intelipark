import{C as pe,aG as Be,V as re,aH as ue,aI as te,r as w,F as kl,q as N,bc as Ce,i as Q,j as he,o as h,c as z,a as V,N as we,bd as De,d as l,be as Te,s as U,al as de,k as ce,a2 as ke,e as B,a5 as M,_ as _e,v as Ne,J as ze,I as Cl,G as Ul,bf as Pl,H as Se,n as xe,x as $e,D as fe,W as Bl,aw as Dl,f as $,w as a,as as ie,M as J,ag as L,b as e,bg as Tl,ak as Nl,bh as Ue,aK as ve,R as Ae,aN as Re,aO as Me,aV as Fe,aQ as Le,az as Ge,P as Oe,E as j}from"./index-BYnOmLgs.js";import{E as qe,a as je,b as Ke,c as We,d as Ye,v as Ze,_ as zl}from"./el-table-column-D9Nd35iY.js";import"./el-scrollbar-DV6-zTQg.js";import"./el-popper-BrjVVlda.js";import{a as He,E as Je}from"./el-form-item-BfmFyFZr.js";import"./el-tooltip-l0sNRNKZ.js";import{U as oe,C as ge,c as Qe,b as Xe,u as xl,e as el,f as ll,d as al,I as Ee,t as $l,E as tl,a as ol}from"./el-input-f41vfBh9.js";import{_ as nl,b as sl,c as il,e as rl}from"./index-Bv4ZD89Z.js";import{v as Al,E as Rl}from"./el-date-picker-CLMGyaZ5.js";import{E as ul}from"./el-row-B8trYvL9.js";import{i as Ml,E as be}from"./el-overlay-ClMggpZ6.js";import{_ as dl}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{e as Fl,a as Ll,g as Gl,b as Ol,d as Pe}from"./user-CD6z7JRO.js";import{u as cl,a as ql}from"./constants-CvswaA_c.js";import"./scroll-CplRQ0RF.js";import"./debounce-CbyCVUEG.js";import"./index-KrsLtwaK.js";const pl=pe({modelValue:{type:[String,Number,Boolean],default:void 0},size:Be,disabled:Boolean,label:{type:[String,Number,Boolean],default:void 0},value:{type:[String,Number,Boolean],default:void 0},name:{type:String,default:void 0}}),jl=pe({...pl,border:Boolean}),vl={[oe]:r=>re(r)||ue(r)||te(r),[ge]:r=>re(r)||ue(r)||te(r)},ml=Symbol("radioGroupKey"),fl=(r,y)=>{const v=w(),o=kl(ml,void 0),p=N(()=>!!o),I=N(()=>Ce(r.value)?r.label:r.value),i=N({get(){return p.value?o.modelValue:r.modelValue},set(_){p.value?o.changeEvent(_):y&&y(oe,_),v.value.checked=r.modelValue===I.value}}),g=Qe(N(()=>o==null?void 0:o.size)),n=Xe(N(()=>o==null?void 0:o.disabled)),c=w(!1),b=N(()=>n.value||p.value&&i.value!==I.value?-1:0);return xl({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-radio",ref:"https://element-plus.org/en-US/component/radio.html"},N(()=>p.value&&Ce(r.value))),{radioRef:v,isGroup:p,radioGroup:o,focus:c,size:g,disabled:n,tabIndex:b,modelValue:i,actualValue:I}},Kl=Q({name:"ElRadio"}),Wl=Q({...Kl,props:jl,emits:vl,setup(r,{emit:y}){const v=r,o=he("radio"),{radioRef:p,radioGroup:I,focus:i,size:g,disabled:n,modelValue:c,actualValue:b}=fl(v,y);function _(){ke(()=>y("change",c.value))}return(S,D)=>{var A;return h(),z("label",{class:U([l(o).b(),l(o).is("disabled",l(n)),l(o).is("focus",l(i)),l(o).is("bordered",S.border),l(o).is("checked",l(c)===l(b)),l(o).m(l(g))])},[V("span",{class:U([l(o).e("input"),l(o).is("disabled",l(n)),l(o).is("checked",l(c)===l(b))])},[we(V("input",{ref_key:"radioRef",ref:p,"onUpdate:modelValue":K=>Te(c)?c.value=K:null,class:U(l(o).e("original")),value:l(b),name:S.name||((A=l(I))==null?void 0:A.name),disabled:l(n),checked:l(c)===l(b),type:"radio",onFocus:K=>i.value=!0,onBlur:K=>i.value=!1,onChange:_,onClick:de(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","checked","onFocus","onBlur","onClick"]),[[De,l(c)]]),V("span",{class:U(l(o).e("inner"))},null,2)],2),V("span",{class:U(l(o).e("label")),onKeydown:de(()=>{},["stop"])},[ce(S.$slots,"default",{},()=>[B(M(S.label),1)])],42,["onKeydown"])],2)}}});var Yl=_e(Wl,[["__file","radio.vue"]]);const Zl=pe({...pl}),Hl=Q({name:"ElRadioButton"}),Jl=Q({...Hl,props:Zl,setup(r){const y=r,v=he("radio"),{radioRef:o,focus:p,size:I,disabled:i,modelValue:g,radioGroup:n,actualValue:c}=fl(y),b=N(()=>({backgroundColor:(n==null?void 0:n.fill)||"",borderColor:(n==null?void 0:n.fill)||"",boxShadow:n!=null&&n.fill?`-1px 0 0 0 ${n.fill}`:"",color:(n==null?void 0:n.textColor)||""}));return(_,S)=>{var D;return h(),z("label",{class:U([l(v).b("button"),l(v).is("active",l(g)===l(c)),l(v).is("disabled",l(i)),l(v).is("focus",l(p)),l(v).bm("button",l(I))])},[we(V("input",{ref_key:"radioRef",ref:o,"onUpdate:modelValue":A=>Te(g)?g.value=A:null,class:U(l(v).be("button","original-radio")),value:l(c),type:"radio",name:_.name||((D=l(n))==null?void 0:D.name),disabled:l(i),onFocus:A=>p.value=!0,onBlur:A=>p.value=!1,onClick:de(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","onFocus","onBlur","onClick"]),[[De,l(g)]]),V("span",{class:U(l(v).be("button","inner")),style:Ne(l(g)===l(c)?l(b):{}),onKeydown:de(()=>{},["stop"])},[ce(_.$slots,"default",{},()=>[B(M(_.label),1)])],46,["onKeydown"])],2)}}});var gl=_e(Jl,[["__file","radio-button.vue"]]);const Ql=pe({id:{type:String,default:void 0},size:Be,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:void 0},fill:{type:String,default:""},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0},...cl(["ariaLabel"])}),Xl=vl,ea=Q({name:"ElRadioGroup"}),la=Q({...ea,props:Ql,emits:Xl,setup(r,{emit:y}){const v=r,o=he("radio"),p=ql(),I=w(),{formItem:i}=el(),{inputId:g,isLabeledByFormItem:n}=ll(v,{formItemContext:i}),c=_=>{y(oe,_),ke(()=>y("change",_))};ze(()=>{const _=I.value.querySelectorAll("[type=radio]"),S=_[0];!Array.from(_).some(D=>D.checked)&&S&&(S.tabIndex=0)});const b=N(()=>v.name||p.value);return Cl(ml,Ul({...Pl(v),changeEvent:c,name:b})),Se(()=>v.modelValue,()=>{v.validateEvent&&(i==null||i.validate("change").catch(_=>al()))}),(_,S)=>(h(),z("div",{id:l(g),ref_key:"radioGroupRef",ref:I,class:U(l(o).b("group")),role:"radiogroup","aria-label":l(n)?void 0:_.ariaLabel||"radio-group","aria-labelledby":l(n)?l(i).labelId:void 0},[ce(_.$slots,"default")],10,["id","aria-label","aria-labelledby"]))}});var bl=_e(la,[["__file","radio-group.vue"]]);xe(Yl,{RadioButton:gl,RadioGroup:bl});const aa=$e(bl),ta=$e(gl),oa=pe({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:Ml},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:fe},activeActionIcon:{type:fe},activeIcon:{type:fe},inactiveIcon:{type:fe},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:Bl(Function)},id:String,tabindex:{type:[String,Number]},...cl(["ariaLabel"])}),na={[oe]:r=>te(r)||re(r)||ue(r),[ge]:r=>te(r)||re(r)||ue(r),[Ee]:r=>te(r)||re(r)||ue(r)},hl="ElSwitch",sa=Q({name:hl}),ia=Q({...sa,props:oa,emits:na,setup(r,{expose:y,emit:v}){const o=r,{formItem:p}=el(),I=Qe(),i=he("switch"),{inputId:g}=ll(o,{formItemContext:p}),n=Xe(N(()=>o.loading)),c=w(o.modelValue!==!1),b=w(),_=w(),S=N(()=>[i.b(),i.m(I.value),i.is("disabled",n.value),i.is("checked",E.value)]),D=N(()=>[i.e("label"),i.em("label","left"),i.is("active",!E.value)]),A=N(()=>[i.e("label"),i.em("label","right"),i.is("active",E.value)]),K=N(()=>({width:Nl(o.width)}));Se(()=>o.modelValue,()=>{c.value=!0});const X=N(()=>c.value?o.modelValue:!1),E=N(()=>X.value===o.activeValue);[o.activeValue,o.inactiveValue].includes(X.value)||(v(oe,o.inactiveValue),v(ge,o.inactiveValue),v(Ee,o.inactiveValue)),Se(E,s=>{var T;b.value.checked=s,o.validateEvent&&((T=p==null?void 0:p.validate)==null||T.call(p,"change").catch(se=>al()))});const Y=()=>{const s=E.value?o.inactiveValue:o.activeValue;v(oe,s),v(ge,s),v(Ee,s),ke(()=>{b.value.checked=E.value})},ee=()=>{if(n.value)return;const{beforeChange:s}=o;if(!s){Y();return}const T=s();[Ue(T),te(T)].includes(!0)||$l(hl,"beforeChange must return type `Promise<boolean>` or `boolean`"),Ue(T)?T.then(le=>{le&&Y()}).catch(le=>{}):T&&Y()},ne=()=>{var s,T;(T=(s=b.value)==null?void 0:s.focus)==null||T.call(s)};return ze(()=>{b.value.checked=E.value}),y({focus:ne,checked:E}),(s,T)=>(h(),z("div",{class:U(l(S)),onClick:de(ee,["prevent"])},[V("input",{id:l(g),ref_key:"input",ref:b,class:U(l(i).e("input")),type:"checkbox",role:"switch","aria-checked":l(E),"aria-disabled":l(n),"aria-label":s.ariaLabel,name:s.name,"true-value":s.activeValue,"false-value":s.inactiveValue,disabled:l(n),tabindex:s.tabindex,onChange:Y,onKeydown:Dl(ee,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!s.inlinePrompt&&(s.inactiveIcon||s.inactiveText)?(h(),z("span",{key:0,class:U(l(D))},[s.inactiveIcon?(h(),$(l(J),{key:0},{default:a(()=>[(h(),$(ie(s.inactiveIcon)))]),_:1})):L("v-if",!0),!s.inactiveIcon&&s.inactiveText?(h(),z("span",{key:1,"aria-hidden":l(E)},M(s.inactiveText),9,["aria-hidden"])):L("v-if",!0)],2)):L("v-if",!0),V("span",{ref_key:"core",ref:_,class:U(l(i).e("core")),style:Ne(l(K))},[s.inlinePrompt?(h(),z("div",{key:0,class:U(l(i).e("inner"))},[s.activeIcon||s.inactiveIcon?(h(),$(l(J),{key:0,class:U(l(i).is("icon"))},{default:a(()=>[(h(),$(ie(l(E)?s.activeIcon:s.inactiveIcon)))]),_:1},8,["class"])):s.activeText||s.inactiveText?(h(),z("span",{key:1,class:U(l(i).is("text")),"aria-hidden":!l(E)},M(l(E)?s.activeText:s.inactiveText),11,["aria-hidden"])):L("v-if",!0)],2)):L("v-if",!0),V("div",{class:U(l(i).e("action"))},[s.loading?(h(),$(l(J),{key:0,class:U(l(i).is("loading"))},{default:a(()=>[e(l(Tl))]),_:1},8,["class"])):l(E)?ce(s.$slots,"active-action",{key:1},()=>[s.activeActionIcon?(h(),$(l(J),{key:0},{default:a(()=>[(h(),$(ie(s.activeActionIcon)))]),_:1})):L("v-if",!0)]):l(E)?L("v-if",!0):ce(s.$slots,"inactive-action",{key:2},()=>[s.inactiveActionIcon?(h(),$(l(J),{key:0},{default:a(()=>[(h(),$(ie(s.inactiveActionIcon)))]),_:1})):L("v-if",!0)])],2)],6),!s.inlinePrompt&&(s.activeIcon||s.activeText)?(h(),z("span",{key:1,class:U(l(A))},[s.activeIcon?(h(),$(l(J),{key:0},{default:a(()=>[(h(),$(ie(s.activeIcon)))]),_:1})):L("v-if",!0),!s.activeIcon&&s.activeText?(h(),z("span",{key:1,"aria-hidden":!l(E)},M(s.activeText),9,["aria-hidden"])):L("v-if",!0)],2)):L("v-if",!0)],10,["onClick"]))}});var ra=_e(ia,[["__file","switch.vue"]]);const ua=xe(ra),da=r=>ve({url:"/vehicle/list",params:r}),ca=r=>ve({url:"/vehicle",method:"DELETE",params:{vehicleId:r}}),pa=r=>ve({url:"/vehicle",method:"POST",data:r}),va=r=>ve({url:"/vehicle",method:"PUT",data:r}),ma=r=>ve({url:"/vehicle",method:"DELETE",data:r}),fa={class:"box-container"},ga={class:"top-elform-query"},ba={__name:"VehicleTable",props:{userId:Number},setup(r){const y=w(!0),v=r;console.log("车辆Box获取user-id:"+v.userId);const o=w(0),p=w({pageNum:1,pageSize:20,searchWord:"",vehicleModel:"",userId:v.userId}),I=w([]),i=w([]),g=w(!1),n=w(!0),c=w(),b=w(),_=async k=>{k===2?(g.value=!g.value,console.log("取消对话框操作"),b.value&&b.value.resetFields()):k===1?(console.log("确认对话框操作"),b.value&&await b.value.validate(),g.value=!g.value,n.value?(await va(c.value)).data.code===200&&j.success("编辑成功"):(await pa(c.value)).data.code===200&&j.success("添加成功"),S()):k===3?(console.log("重置对话框操作"),b.value&&b.value.resetFields()):console.log(Promise.reject("对话框返回数字错误")),console.log("结束对话框操作")},S=async()=>{y.value=!0;const k=await da(p.value);o.value=k.data.data.totalRow,I.value=k.data.data.records,y.value=!1};S();const D=k=>{i.value=k},A=()=>{console.log("submit!"),S()},K=()=>{console.log("信息添加逻辑"),c.value={vehicleId:0,userId:0,vehicleBrand:"",vehicleModel:1,licencePlate:"",electricity:0},n.value=!1,g.value=!g.value},X=k=>{console.log("单行编辑操作"),c.value=JSON.parse(JSON.stringify(k)),n.value=!0,g.value=!g.value},E=async k=>{console.log("单行删除操作"+k),await be.confirm("你确认要删除该条信息么？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}).then(async()=>{(await ca(k)).data.code===200&&j.success("删除成功"),S()}).catch(()=>{})},Y=async()=>{if(i.value.length===0){j.error("未选中任何数据");return}const k=i.value.map(d=>d.id);await be.confirm("你确认要删除多条信息么？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}).then(async()=>{(await ma(k)).data.code===200&&j.success("删除成功"),S()}).catch(()=>{})},ee=()=>{console.log(p.value.pageSize),S()},ne=()=>{console.log(p.value.pageNum),S()};function s(k,d,x){/^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$/.test(d)?x():x(new Error("请输入有效的车牌"))}function T(k,d,x){/^\d+(\.\d{2})?$/.test(d)?x():x(new Error("请输入有效的电量（保留两位小数）"))}const se={userId:[{required:!0,message:"未输入用户ID",trigger:"manual"}],vehicleBrand:[{required:!0,message:"未输入汽车品牌",trigger:"manual"}],licencePlate:[{required:!0,message:"未输入车牌",trigger:"manual"},{validator:s,trigger:"manual"}],electricity:[{required:!0,message:"未输入电量",trigger:"manual"},{validator:T,trigger:"manual"}]},le=()=>{console.log("重置查询表单"),p.value={pageNum:1,pageSize:20,searchWord:"",vehicleModel:"",userId:""}};return(k,d)=>{const x=tl,R=He,m=ul,t=qe,C=je,W=Je,P=nl,Z=J,F=ol,G=sl,ae=il,ye=rl,O=Ke,me=We,Ve=Ye,H=Ze;return h(),z(Oe,null,[e(P,{selectShow:g.value,dialogTitle:"车辆基础信息"+(n.value?"编辑":"添加"),onDoneEditAdd:_},{default:a(()=>[e(W,{ref_key:"ruleFormRef",ref:b,model:c.value,rules:se,"label-width":"auto","status-icon":""},{default:a(()=>[e(m,{justify:"space-between"},{default:a(()=>[e(R,{label:"用户id",prop:"userId"},{default:a(()=>[e(x,{modelValue:c.value.userId,"onUpdate:modelValue":d[0]||(d[0]=f=>c.value.userId=f),formatter:f=>f.replace(/\D/g,""),parser:f=>f.replace(/\D/g,""),placeholder:"输入用户id",clearable:"",style:{width:"200px"}},null,8,["modelValue","formatter","parser"])]),_:1}),e(R,{label:"汽车品牌",prop:"vehicleBrand",style:{width:"360px"},clearable:""},{default:a(()=>[e(x,{modelValue:c.value.vehicleBrand,"onUpdate:modelValue":d[1]||(d[1]=f=>c.value.vehicleBrand=f),placeholder:"请输入汽车品牌"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{justify:"space-between"},{default:a(()=>[e(R,{label:"充电车型",prop:"vehicleModel",style:{width:"360px"}},{default:a(()=>[e(C,{modelValue:c.value.vehicleModel,"onUpdate:modelValue":d[2]||(d[2]=f=>c.value.vehicleModel=f),placeholder:"请选择"},{default:a(()=>[e(t,{label:"直流快充",value:1}),e(t,{label:"交流慢充",value:2}),e(t,{label:"交直流混合充电",value:3})]),_:1},8,["modelValue"])]),_:1}),e(R,{label:"车牌号",prop:"licencePlate",style:{width:"360px"},clearable:""},{default:a(()=>[e(x,{modelValue:c.value.licencePlate,"onUpdate:modelValue":d[3]||(d[3]=f=>c.value.licencePlate=f),placeholder:"请输入车牌号"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{justify:"space-between"},{default:a(()=>[e(R,{label:"电池容量",prop:"electricity",style:{width:"360px"},clearable:""},{default:a(()=>[e(x,{modelValue:c.value.electricity,"onUpdate:modelValue":d[4]||(d[4]=f=>c.value.electricity=f),placeholder:"请输入电池容量"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["selectShow","dialogTitle"]),V("div",fa,[V("div",ga,[e(ye,{class:"el-dropdown-del-all"},{dropdown:a(()=>[e(ae,null,{default:a(()=>[e(G,{onClick:Y},{default:a(()=>d[9]||(d[9]=[B("全部删除")])),_:1})]),_:1})]),default:a(()=>[e(F,{type:"primary"},{default:a(()=>[B(M(i.value.length===0?"未选中":`选中${i.value.length}行`)+" ",1),e(Z,{class:"el-icon--right"},{default:a(()=>[e(l(Ae))]),_:1})]),_:1})]),_:1}),d[13]||(d[13]=V("h1",null,"用户车辆信息",-1)),e(W,{inline:!0,model:p.value,style:{"text-align":"end"}},{default:a(()=>[e(R,{label:"搜索关键字"},{default:a(()=>[e(x,{modelValue:p.value.searchWord,"onUpdate:modelValue":d[5]||(d[5]=f=>p.value.searchWord=f),placeholder:"输入关键字",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),e(R,{label:"充电车型"},{default:a(()=>[e(C,{modelValue:p.value.vehicleModel,"onUpdate:modelValue":d[6]||(d[6]=f=>p.value.vehicleModel=f),placeholder:"请选择",clearable:"",style:{width:"150px"}},{default:a(()=>[e(t,{label:"直流快充",value:"1"}),e(t,{label:"交流慢充",value:"2"}),e(t,{label:"交直流混合充电",value:"3"})]),_:1},8,["modelValue"])]),_:1}),e(R,null,{default:a(()=>[e(F,{plain:"",type:"warning",onClick:le,icon:l(Re)},{default:a(()=>d[10]||(d[10]=[B("重置")])),_:1},8,["icon"]),e(F,{type:"primary",onClick:A,icon:l(Me)},{default:a(()=>d[11]||(d[11]=[B("查询")])),_:1},8,["icon"]),e(F,{type:"success",onClick:K,icon:l(Fe)},{default:a(()=>d[12]||(d[12]=[B("添加")])),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),we((h(),$(me,{border:"",data:I.value,style:{width:"100%"},"highlight-current-row":"",onSelectionChange:D},{default:a(()=>[e(O,{type:"selection",width:"55"}),e(O,{fixed:"","show-overflow-tooltip":"",prop:"vehicleId",label:"车辆ID",width:"100"}),e(O,{fixed:"","show-overflow-tooltip":"",prop:"userId",label:"用户ID",width:"100"}),e(O,{prop:"vehicleBrand",label:"车辆品牌",width:"200"}),e(O,{prop:"vehicleModel",label:"充电车型",width:"200"},{default:a(f=>[V("div",null,M([1,2,3].includes(f.row.vehicleModel)?l(Al)[f.row.vehicleModel-1]:"未知车型"),1)]),_:1}),e(O,{prop:"licencePlate",label:"车牌号",width:"200"}),e(O,{prop:"electricity",label:"电池容量","min-width":"200"},{default:a(f=>[V("div",null,M(f.row.electricity+" kWh"),1)]),_:1}),e(O,{fixed:"right",label:"单行操作",width:"200"},{default:a(f=>[e(F,{text:"",bg:"",type:"primary",size:"small",onClick:Ie=>X(f.row),icon:l(Le)},{default:a(()=>d[14]||(d[14]=[B(" 编辑 ")])),_:2},1032,["onClick","icon"]),e(F,{text:"",bg:"",type:"danger",size:"small",onClick:Ie=>E(f.row.vehicleId),icon:l(Ge)},{default:a(()=>d[15]||(d[15]=[B(" 删除 ")])),_:2},1032,["onClick","icon"])]),_:1})]),_:1},8,["data"])),[[H,y.value]]),e(Ve,{style:{"margin-top":"10px"},"current-page":p.value.pageNum,"onUpdate:currentPage":d[7]||(d[7]=f=>p.value.pageNum=f),"page-size":p.value.pageSize,"onUpdate:pageSize":d[8]||(d[8]=f=>p.value.pageSize=f),"page-sizes":[10,15,20,40],layout:"total, sizes, prev, pager, next, jumper",total:o.value,onSizeChange:ee,onCurrentChange:ne,"hide-on-single-page":""},null,8,["current-page","page-size","total"])])],64)}}},ha=dl(ba,[["__scopeId","data-v-d13a4413"]]),wa={class:"top-elform-query"},_a={key:0},ya={key:1,style:{"text-align":"center"}},Va={__name:"BasicUser",setup(r){const y=w(!0),v=w(0),o=w({pageNum:1,pageSize:20,searchWord:"",state:"",vip:"",role:"",userId:""}),p=w([]),I=w([]),i=w(!1),g=w(!0),n=w(),c=w(),b=()=>{const m=new URLSearchParams(window.location.search);o.value.userId&&m.set("userId",o.value.userId);const t=m.toString()===""?window.location.pathname:`?${m}`,C=history.state?history.state:null;window.history.replaceState(C,"",t)};(()=>{const t=new URLSearchParams(window.location.search).get("userId");t&&(o.value.userId=t),b()})();const S=async m=>{m===2?(i.value=!i.value,console.log("取消对话框操作"),c.value&&c.value.resetFields()):m===1?(console.log("确认对话框操作"),c.value&&await c.value.validate(),i.value=!i.value,g.value?(await Fl(n.value)).data.code===200&&j.success("编辑成功"):(await Ll(n.value)).data.code===200&&j.success("添加成功"),D()):m===3?(console.log("重置对话框操作"),c.value&&c.value.resetFields()):console.log(Promise.reject("对话框返回数字错误")),console.log("结束对话框操作")},D=async()=>{y.value=!0;const m=await Gl(o.value);v.value=m.data.data.totalRow,p.value=m.data.data.records,y.value=!1,b()},A=async()=>{y.value=!0;const m=await Ol(o.value.userId);v.value=1,p.value=[m.data.data],y.value=!1};o.value.userId?A():D();const K=m=>{I.value=m},X=()=>{console.log("submit!"),D()},E=()=>{console.log("信息添加逻辑"),n.value={id:0,username:"",state:1,phoneNum:"",balance:0,vip:0,vipDisableTime:"",password:"",role:"admin"},g.value=!1,i.value=!i.value},Y=m=>{console.log("单行编辑操作"),n.value=JSON.parse(JSON.stringify(m)),g.value=!0,i.value=!i.value},ee=async m=>{console.log("单行删除操作"+m),await be.confirm("你确认要删除该条信息么？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}).then(async()=>{(await Pe([m])).data.code===200&&j.success("删除成功"),D()}).catch(()=>{})},ne=async()=>{if(I.value.length===0){j.error("未选中任何数据");return}const m=I.value.map(t=>t.id);await be.confirm("你确认要删除多条信息么？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}).then(async()=>{(await Pe(m)).data.code===200&&j.success("删除成功"),D()}).catch(()=>{})},s=()=>{console.log(o.value.pageSize),D()},T=()=>{console.log(o.value.pageNum),D()};function se(m,t,C){const W=new Date(t),P=new Date;console.log(t),W>P?C():C(new Error("所选日期应该大于当前时间"))}function le(m,t,C){/^\d{11}$/.test(t)?C():C(new Error("请输入有效的手机号"))}function k(m,t,C){/^\d+(\.\d{2})?$/.test(t)?C():C(new Error("请输入有效的金额（保留两位小数）"))}function d(m,t,C){/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/.test(t)?C():C(new Error("请输入有效的金额（保留两位小数）"))}const x={username:[{required:!0,message:"未输入用户名",trigger:"manual"},{min:1,max:20,message:"用户名长度为1-20个字符",trigger:"manual"}],phoneNum:[{required:!0,message:"未输入电话号码",trigger:"manual"},{validator:le,trigger:"manual"}],vipDisableTime:[{required:!0,message:"未选择日期",trigger:"manual"},{validator:se,trigger:"manual"}],balance:[{required:!0,message:"未输入余额",trigger:"manual"},{validator:k,trigger:"manual"}],password:[{required:!0,message:"未输入密码",trigger:"manual"},{min:8,message:"密码长度至少为8个字符",trigger:"manual"},{validator:d,message:"密码需要包含字母和数字",trigger:"manual"}]},R=()=>{console.log("重置查询表单"),o.value={pageNum:1,pageSize:20,searchWord:"",state:"",vip:"",role:""}};return(m,t)=>{const C=ta,W=aa,P=He,Z=tl,F=ul,G=qe,ae=je,ye=ua,O=Rl,me=Je,Ve=nl,H=ol,f=J,Ie=sl,wl=il,_l=rl,q=Ke,yl=We,Vl=Ye,Il=zl,Sl=Ze;return h(),z(Oe,null,[e(Ve,{selectShow:i.value,dialogTitle:"用户基础信息"+(g.value?"编辑":"添加"),onDoneEditAdd:S},{default:a(()=>[e(me,{ref_key:"ruleFormRefUser",ref:c,model:n.value,rules:x,"label-width":"auto","status-icon":""},{default:a(()=>[e(F,{justify:"space-between"},{default:a(()=>[e(P,{label:"角色",prop:"role"},{default:a(()=>[e(W,{modelValue:n.value.role,"onUpdate:modelValue":t[0]||(t[0]=u=>n.value.role=u)},{default:a(()=>[e(C,{value:"user"},{default:a(()=>t[15]||(t[15]=[B("普通用户")])),_:1}),e(C,{value:"admin"},{default:a(()=>t[16]||(t[16]=[B("系统管理员")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e(P,{label:"用户名",prop:"username",style:{width:"360px"},clearable:""},{default:a(()=>[e(Z,{modelValue:n.value.username,"onUpdate:modelValue":t[1]||(t[1]=u=>n.value.username=u),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1})]),_:1}),e(F,{justify:"space-between"},{default:a(()=>[e(P,{label:"账户状态",prop:"state",style:{width:"360px"}},{default:a(()=>[e(ae,{modelValue:n.value.state,"onUpdate:modelValue":t[2]||(t[2]=u=>n.value.state=u),placeholder:"请选择"},{default:a(()=>[e(G,{label:"正常",value:1}),e(G,{label:"锁定",value:2})]),_:1},8,["modelValue"])]),_:1}),e(P,{label:"手机号",prop:"phoneNum",style:{width:"360px"},clearable:""},{default:a(()=>[e(Z,{modelValue:n.value.phoneNum,"onUpdate:modelValue":t[3]||(t[3]=u=>n.value.phoneNum=u),placeholder:"请输入电话号码"},null,8,["modelValue"])]),_:1})]),_:1}),e(F,{justify:"space-between"},{default:a(()=>[e(P,{label:"VIP身份",prop:"vip"},{default:a(()=>[e(ye,{modelValue:n.value.vip,"onUpdate:modelValue":t[4]||(t[4]=u=>n.value.vip=u),disabled:n.value.role==="admin","active-value":1,"inactive-value":0},null,8,["modelValue","disabled"])]),_:1}),e(P,{label:"VIP到期时间",prop:n.value.vip===1?"vipDisableTime":"",style:{width:"360px"}},{default:a(()=>[e(O,{modelValue:n.value.vipDisableTime,"onUpdate:modelValue":t[5]||(t[5]=u=>n.value.vipDisableTime=u),type:"datetime",placeholder:"选择时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD h:m:s",disabled:n.value.vip===0},null,8,["modelValue","disabled"])]),_:1},8,["prop"])]),_:1}),e(F,{justify:"space-between"},{default:a(()=>[e(P,{label:"用户余额",prop:"balance",style:{width:"360px"}},{default:a(()=>[e(Z,{modelValue:n.value.balance,"onUpdate:modelValue":t[6]||(t[6]=u=>n.value.balance=u),disabled:n.value.role==="admin",placeholder:"输入用户余额"},null,8,["modelValue","disabled"])]),_:1}),e(P,{label:"登录密码",prop:"password",style:{width:"360px"}},{default:a(()=>[e(Z,{modelValue:n.value.password,"onUpdate:modelValue":t[7]||(t[7]=u=>n.value.password=u),type:"password",placeholder:"输入密码","show-password":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["selectShow","dialogTitle"]),e(Il,{title:!0},{header:a(()=>[t[18]||(t[18]=V("span",null,"用户基础信息管理",-1)),V("div",null,[e(H,{type:"success",onClick:E,icon:l(Fe)},{default:a(()=>t[17]||(t[17]=[B("添加")])),_:1},8,["icon"])])]),content:a(()=>[V("div",wa,[e(_l,{class:"el-dropdown-del-all"},{dropdown:a(()=>[e(wl,null,{default:a(()=>[e(Ie,{onClick:ne},{default:a(()=>t[19]||(t[19]=[B("全部删除")])),_:1})]),_:1})]),default:a(()=>[e(H,{type:"primary"},{default:a(()=>[B(M(I.value.length===0?"未选中":`选中${I.value.length}行`)+" ",1),e(f,{class:"el-icon--right"},{default:a(()=>[e(l(Ae))]),_:1})]),_:1})]),_:1}),e(me,{inline:!0,model:o.value,style:{"text-align":"end"}},{default:a(()=>[e(P,{label:"搜索关键字"},{default:a(()=>[e(Z,{modelValue:o.value.searchWord,"onUpdate:modelValue":t[8]||(t[8]=u=>o.value.searchWord=u),placeholder:"输入关键字",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(P,{label:"用户ID"},{default:a(()=>[e(Z,{modelValue:o.value.userId,"onUpdate:modelValue":t[9]||(t[9]=u=>o.value.userId=u),formatter:u=>u.replace(/\D/g,""),parser:u=>u.replace(/\D/g,""),placeholder:"输入用户ID",clearable:"",style:{width:"200px"}},null,8,["modelValue","formatter","parser"])]),_:1}),e(P,{label:"账户状态"},{default:a(()=>[e(ae,{modelValue:o.value.state,"onUpdate:modelValue":t[10]||(t[10]=u=>o.value.state=u),placeholder:"请选择",clearable:"",style:{width:"200px"}},{default:a(()=>[e(G,{label:"正常",value:"1"}),e(G,{label:"锁定",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(P,{label:"VIP身份"},{default:a(()=>[e(ae,{modelValue:o.value.vip,"onUpdate:modelValue":t[11]||(t[11]=u=>o.value.vip=u),placeholder:"请选择",clearable:"",style:{width:"200px"}},{default:a(()=>[e(G,{label:"VIP用户",value:"1"}),e(G,{label:"非VIP用户",value:"0"})]),_:1},8,["modelValue"])]),_:1}),e(P,{label:"角色"},{default:a(()=>[e(ae,{modelValue:o.value.role,"onUpdate:modelValue":t[12]||(t[12]=u=>o.value.role=u),placeholder:"请选择",clearable:"",style:{width:"200px"}},{default:a(()=>[e(G,{label:"普通用户",value:"user"}),e(G,{label:"系统管理员",value:"admin"})]),_:1},8,["modelValue"])]),_:1}),e(P,null,{default:a(()=>[e(H,{plain:"",type:"warning",onClick:R,icon:l(Re)},{default:a(()=>t[20]||(t[20]=[B("重置")])),_:1},8,["icon"]),e(H,{type:"primary",onClick:X,icon:l(Me)},{default:a(()=>t[21]||(t[21]=[B("查询")])),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),we((h(),$(yl,{data:p.value,style:{width:"100%"},"highlight-current-row":"",onSelectionChange:K},{default:a(()=>[e(q,{type:"selection",width:"55"}),e(q,{type:"expand"},{default:a(u=>[u.row.role==="user"?(h(),z("div",_a,[e(ha,{userId:u.row.id},null,8,["userId"])])):(h(),z("div",ya,"无车辆信息"))]),_:1}),e(q,{"show-overflow-tooltip":"",prop:"id",label:"ID",width:"100"}),e(q,{prop:"role",label:"角色",width:"100"},{default:a(u=>[V("span",null,M(u.row.role==="admin"?"管理员":"用户"),1)]),_:1}),e(q,{prop:"username",label:"用户名",width:"200"}),e(q,{prop:"state",label:"状态",width:"100"},{default:a(u=>[V("span",null,M(u.row.state===1?"正常":"锁定"),1)]),_:1}),e(q,{prop:"phoneNum",label:"手机号",width:"180"}),e(q,{prop:"balance",label:"账户余额",width:"160"}),e(q,{prop:"vip",label:"VIP身份","min-width":"300"},{default:a(u=>[V("span",null,M(u.row.vip===1?`VIP到期时间：${u.row.vipDisableTime}`:"非VIP用户"),1)]),_:1}),e(q,{fixed:"right",label:"单行操作",width:"200"},{default:a(u=>[e(H,{text:"",bg:"",type:"primary",size:"small",onClick:El=>Y(u.row),icon:l(Le)},{default:a(()=>t[22]||(t[22]=[B(" 编辑 ")])),_:2},1032,["onClick","icon"]),e(H,{text:"",bg:"",type:"danger",size:"small",onClick:El=>ee(u.row.id),icon:l(Ge)},{default:a(()=>t[23]||(t[23]=[B(" 删除 ")])),_:2},1032,["onClick","icon"])]),_:1})]),_:1},8,["data"])),[[Sl,y.value]]),t[24]||(t[24]=V("div",{style:{height:"20px"}},null,-1)),e(Vl,{"current-page":o.value.pageNum,"onUpdate:currentPage":t[13]||(t[13]=u=>o.value.pageNum=u),"page-size":o.value.pageSize,"onUpdate:pageSize":t[14]||(t[14]=u=>o.value.pageSize=u),"page-sizes":[10,15,20,40],layout:"total, sizes, prev, pager, next, jumper",total:v.value,onSizeChange:s,onCurrentChange:T,"hide-on-single-page":""},null,8,["current-page","page-size","total"]),t[25]||(t[25]=V("div",{style:{height:"10px"}},null,-1))]),_:1})],64)}}},Fa=dl(Va,[["__scopeId","data-v-23b400f2"]]);export{Fa as default};
